# Interlude: proof

## Exercise 4 (example)

The previous examples used already-proven properties of standard functions to justify each step, but if we need to prove
something about a new function, we can work from its definition. We assume it is a lambda function.

Specifically, an expression of the form `(lambda x: <expr>)(y)` can be simplified to `<expr>` with every occurrence of
`x` changed to `y`. This is just applying the function, but its formal name is **beta-reduction**.

For example, `(lambda x: x(y(x)))(z)` reduces to `z(y(z))`, while `(lambda n: n + n)(2)` reduces to `2 + 2`
which we will then otherwise simplify to `4`.

> To be pedantic, `(lambda x: <expr>)(y)` simplifies to `<expr>` with every **free** occurrence of `x` changed to `y`.
> An occurrence of `x` is free if it does not occur inside another `lambda x:`. So
> `(lambda x: x(lambda y: (lambda x: x(y))))(y)` simplifies to `y(lambda y: (lambda x: x(y)))`, not to
> `y(lambda y: (lambda x: y(y)))` or `y(lambda y: (lambda y: y(y)))`. This only happens
> when two nested lambdas have the same parameter name, which we will ignore anyway.

Opposite is a proof that `(lambda f: f(idem))(lambda g: (lambda h: (lambda x: g(h(x))))) ≡ idem`. We start by applying the
expression to two arbitrary variables `y` and `z`. At each step, we apply a single beta reduction or the definition of a
standard function. In the last two steps, we remove the arbitrary variables, recalling that two functions are equal if
they produce the same outputs for the same inputs.

```
(lambda f: f(idem))(lambda g: (lambda h: (lambda x: g(h(x)))))(y)(z)
≡ (lambda g: (lambda h: (lambda x: g(h(x)))))(idem)(y)(z)                      beta-reduction
≡ (lambda h: (lambda x: idem(h(x))))(y)(z)                                     beta-reduction
≡ (lambda h: (lambda x: h(x)))(y)(z)                                           definition of idem
≡ (lambda x: y(x))(z)                                                          beta-reduction
≡ y(z)                                                                         beta-reduction
≡ idem(y)(z)                                                                   substituting out the definition of idem
⇒ (lambda f: f(idem))(lambda g: (lambda h: (lambda x: g(h(x)))))(y) ≡ idem(y)  extensional equality
⇒ (lambda f: f(idem))(lambda g: (lambda h: (lambda x: g(h(x))))) ≡ idem        extensional equality
```
